2024-12-02 17:26:01.916 | INFO     | data_juicer.config.config:config_backup:646 - Back up the input config file [/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/HumanCentricVideoAnnotationPipeline/process.yaml] into the work_dir [/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow]
2024-12-02 17:26:01.956 | INFO     | data_juicer.config.config:display_config:668 - Configuration table: 
╒════════════════════════════╤════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                        │ values                                                                                                     │
╞════════════════════════════╪════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                     │ [Path_fr(/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/HumanCentricVideoAnnotationPipeline/process.yaml)] │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config                 │ None                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ path_k_sigma_recipe        │ None                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ path_model_feedback_recipe │ None                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_infer_config         │ None                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_train_config         │ None                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_eval_config           │ None                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_eval_config          │ None                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_probe_algo            │ 'uniform'                                                                                                  │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_probe_ratio           │ 1.0                                                                                                        │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name               │ 'all'                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type              │ 'default'                                                                                                  │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path               │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow/raw_videos_prcocess1_j_reconstruct.jsonl'  │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path                │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow/raw_videos_prcocess2.jsonl'                │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size          │ 0                                                                                                          │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel         │ False                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds       │ False                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds      │ False                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                         │ 1                                                                                                          │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys                  │ 'text'                                                                                                     │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key                  │ 'images'                                                                                                   │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token        │ '<__dj__image>'                                                                                            │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ audio_key                  │ 'audios'                                                                                                   │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ audio_special_token        │ '<__dj__audio>'                                                                                            │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ video_key                  │ 'videos'                                                                                                   │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ video_special_token        │ '<__dj__video>'                                                                                            │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token          │ '<|__dj__eoc|>'                                                                                            │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes                   │ []                                                                                                         │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache                  │ True                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir               │ '/home/daoyuan_mm/.cache/huggingface/datasets'                                                             │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress             │ None                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint             │ False                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir                   │ None                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer                │ False                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace           │ []                                                                                                         │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num                  │ 10                                                                                                         │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion                  │ False                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                    │ [{'video_duration_filter': {'accelerator': 'cpu',                                                          │
│                            │                             'any_or_all': 'any',                                                           │
│                            │                             'audio_key': 'audios',                                                         │
│                            │                             'cpu_required': 1,                                                             │
│                            │                             'image_key': 'images',                                                         │
│                            │                             'max_duration': 100,                                                           │
│                            │                             'mem_required': 0,                                                             │
│                            │                             'min_duration': 2,                                                             │
│                            │                             'num_proc': 0,                                                                 │
│                            │                             'stats_export_path': None,                                                     │
│                            │                             'text_key': 'text',                                                            │
│                            │                             'use_actor': False,                                                            │
│                            │                             'video_key': 'videos'}},                                                       │
│                            │  {'video_motion_score_filter': {'accelerator': 'cpu',                                                      │
│                            │                                 'any_or_all': 'any',                                                       │
│                            │                                 'audio_key': 'audios',                                                     │
│                            │                                 'cpu_required': 1,                                                         │
│                            │                                 'image_key': 'images',                                                     │
│                            │                                 'max_score': 10000.0,                                                      │
│                            │                                 'mem_required': 0,                                                         │
│                            │                                 'min_score': 1.2,                                                          │
│                            │                                 'num_proc': 0,                                                             │
│                            │                                 'sampling_fps': 2,                                                         │
│                            │                                 'stats_export_path': None,                                                 │
│                            │                                 'text_key': 'text',                                                        │
│                            │                                 'use_actor': False,                                                        │
│                            │                                 'video_key': 'videos'}},                                                   │
│                            │  {'video_face_ratio_filter': {'accelerator': 'cpu',                                                        │
│                            │                               'any_or_all': 'any',                                                         │
│                            │                               'audio_key': 'audios',                                                       │
│                            │                               'cpu_required': 1,                                                           │
│                            │                               'detect_interval': 4,                                                        │
│                            │                               'image_key': 'images',                                                       │
│                            │                               'mem_required': 0,                                                           │
│                            │                               'num_proc': 0,                                                               │
│                            │                               'stats_export_path': None,                                                   │
│                            │                               'text_key': 'text',                                                          │
│                            │                               'threshold': 0.65,                                                           │
│                            │                               'use_actor': False,                                                          │
│                            │                               'video_key': 'videos'}}]                                                     │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ percentiles                │ []                                                                                                         │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_original_dataset    │ False                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file     │ False                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address                │ 'auto'                                                                                                     │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ debug                      │ False                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir                   │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow'                                           │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp                  │ '20241202172558'                                                                                           │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir                │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow'                                           │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix                 │ False                                                                                                      │
╘════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2024-12-02 17:26:01.957 | INFO     | data_juicer.core.executor:__init__:49 - Using cache compression method: [None]
2024-12-02 17:26:01.957 | INFO     | data_juicer.core.executor:__init__:54 - Setting up data formatter...
2024-12-02 17:26:01.958 | INFO     | data_juicer.core.executor:__init__:76 - Preparing exporter...
2024-12-02 17:26:01.958 | INFO     | data_juicer.core.executor:run:153 - Loading dataset from data formatter...
Generating jsonl split: 0 examples [00:00, ? examples/s]Generating jsonl split: 2 examples [00:00, 335.56 examples/s]
2024-12-02 17:26:02.707 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-12-02 17:26:02.707 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 2 sample(s) in the original dataset.
Filter:   0%|          | 0/2 [00:00<?, ? examples/s]Filter: 100%|##########| 2/2 [00:00<00:00, 168.26 examples/s]
2024-12-02 17:26:02.725 | INFO     | data_juicer.format.formatter:unify_format:214 - 2 samples left after filtering empty text.
2024-12-02 17:26:02.725 | INFO     | data_juicer.format.formatter:unify_format:237 - Converting relative paths in the dataset to their absolute version. (Based on the directory of input dataset file)
Map:   0%|          | 0/2 [00:00<?, ? examples/s]Map: 100%|##########| 2/2 [00:00<00:00, 394.42 examples/s]
2024-12-02 17:26:02.735 | INFO     | data_juicer.format.mixture_formatter:load_dataset:137 - sampled 2 from 2
2024-12-02 17:26:02.739 | INFO     | data_juicer.format.mixture_formatter:load_dataset:143 - There are 2 in final dataset
2024-12-02 17:26:02.739 | INFO     | data_juicer.core.executor:run:159 - Preparing process operators...
2024-12-02 17:26:02.936 | INFO     | data_juicer.core.executor:run:166 - Processing data...
Adding new column for stats:   0%|          | 0/2 [00:00<?, ? examples/s]Adding new column for stats: 100%|##########| 2/2 [00:00<00:00, 422.07 examples/s]
video_duration_filter_compute_stats:   0%|          | 0/2 [00:00<?, ? examples/s]video_duration_filter_compute_stats: 100%|##########| 2/2 [00:00<00:00, 166.10 examples/s]
video_duration_filter_process:   0%|          | 0/2 [00:00<?, ? examples/s]video_duration_filter_process: 100%|##########| 2/2 [00:05<00:00,  2.92s/ examples]video_duration_filter_process: 100%|##########| 2/2 [00:05<00:00,  2.92s/ examples]
2024-12-02 17:26:08.813 | INFO     | data_juicer.core.executor:run:255 - Op [video_duration_filter] Done in 5.877(s). Left 2 samples.
video_motion_score_filter_compute_stats:   0%|          | 0/2 [00:00<?, ? examples/s]video_motion_score_filter_compute_stats:  50%|#####     | 1/2 [00:01<00:01,  1.39s/ examples]video_motion_score_filter_compute_stats: 100%|##########| 2/2 [00:04<00:00,  2.43s/ examples]video_motion_score_filter_compute_stats: 100%|##########| 2/2 [00:04<00:00,  2.28s/ examples]
video_motion_score_filter_process:   0%|          | 0/2 [00:00<?, ? examples/s]video_motion_score_filter_process: 100%|##########| 2/2 [00:00<00:00, 381.35 examples/s]
2024-12-02 17:26:13.401 | INFO     | data_juicer.core.executor:run:255 - Op [video_motion_score_filter] Done in 4.587(s). Left 1 samples.
video_face_ratio_filter_compute_stats:   0%|          | 0/1 [00:00<?, ? examples/s]Memory Usage: 1742.60 MB
video_face_ratio_filter_compute_stats: 100%|##########| 1/1 [00:03<00:00,  3.09s/ examples]video_face_ratio_filter_compute_stats: 100%|##########| 1/1 [00:03<00:00,  3.10s/ examples]
video_face_ratio_filter_process:   0%|          | 0/1 [00:00<?, ? examples/s]video_face_ratio_filter_process: 100%|##########| 1/1 [00:00<00:00, 206.71 examples/s]
2024-12-02 17:26:16.520 | INFO     | data_juicer.core.executor:run:255 - Op [video_face_ratio_filter] Done in 3.119(s). Left 1 samples.
2024-12-02 17:26:16.520 | INFO     | data_juicer.core.executor:run:259 - All Ops are done in 13.583(s).
2024-12-02 17:26:16.520 | INFO     | data_juicer.core.executor:run:262 - Exporting dataset to disk...
2024-12-02 17:26:16.521 | INFO     | data_juicer.core.exporter:_export_impl:111 - Exporting computed stats into a single file...
Creating json from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating json from Arrow format: 100%|##########| 1/1 [00:00<00:00, 223.51ba/s]
2024-12-02 17:26:16.537 | INFO     | data_juicer.core.exporter:_export_impl:140 - Export dataset into a single file...
Creating json from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating json from Arrow format: 100%|##########| 1/1 [00:00<00:00, 740.13ba/s]
