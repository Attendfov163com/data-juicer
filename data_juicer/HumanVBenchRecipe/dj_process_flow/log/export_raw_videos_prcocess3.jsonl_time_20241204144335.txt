2024-12-04 14:43:38.508 | INFO     | data_juicer.config.config:config_backup:646 - Back up the input config file [/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/HumanCentricVideoAnnotationPipeline/process.yaml] into the work_dir [/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow]
2024-12-04 14:43:38.546 | INFO     | data_juicer.config.config:display_config:668 - Configuration table: 
╒════════════════════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                        │ values                                                                                                                                                              │
╞════════════════════════════╪═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                     │ [Path_fr(/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/HumanCentricVideoAnnotationPipeline/process.yaml)]                                                          │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config                 │ None                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ path_k_sigma_recipe        │ None                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ path_model_feedback_recipe │ None                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_infer_config         │ None                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_train_config         │ None                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_eval_config           │ None                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_eval_config          │ None                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_probe_algo            │ 'uniform'                                                                                                                                                           │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_probe_ratio           │ 1.0                                                                                                                                                                 │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name               │ 'all'                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type              │ 'default'                                                                                                                                                           │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path               │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow/raw_videos_prcocess2.jsonl'                                                                         │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path                │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow/raw_videos_prcocess3.jsonl'                                                                         │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size          │ 0                                                                                                                                                                   │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel         │ False                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds       │ False                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds      │ False                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                         │ 1                                                                                                                                                                   │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys                  │ 'text'                                                                                                                                                              │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key                  │ 'images'                                                                                                                                                            │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token        │ '<__dj__image>'                                                                                                                                                     │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ audio_key                  │ 'audios'                                                                                                                                                            │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ audio_special_token        │ '<__dj__audio>'                                                                                                                                                     │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ video_key                  │ 'videos'                                                                                                                                                            │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ video_special_token        │ '<__dj__video>'                                                                                                                                                     │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token          │ '<|__dj__eoc|>'                                                                                                                                                     │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes                   │ []                                                                                                                                                                  │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache                  │ True                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir               │ '/home/daoyuan_mm/.cache/huggingface/datasets'                                                                                                                      │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress             │ None                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint             │ False                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir                   │ None                                                                                                                                                                │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer                │ False                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace           │ []                                                                                                                                                                  │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num                  │ 10                                                                                                                                                                  │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion                  │ False                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                    │ [{'video_human_tracks_extraction_mapper': {'YOLOv8_human_model_path': '/home/daoyuan_mm/data_juicer/data_juicer/my_pretrained_method/YOLOv8_human/weights/best.pt', │
│                            │                                            'accelerator': 'cpu',                                                                                                    │
│                            │                                            'audio_key': 'audios',                                                                                                   │
│                            │                                            'batched_op': False,                                                                                                     │
│                            │                                            'cpu_required': 1,                                                                                                       │
│                            │                                            'face_track_bbox_path': '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_human_track',                                 │
│                            │                                            'image_key': 'images',                                                                                                   │
│                            │                                            'mem_required': '10GB',                                                                                                  │
│                            │                                            'num_proc': 0,                                                                                                           │
│                            │                                            'text_key': 'text',                                                                                                      │
│                            │                                            'use_actor': False,                                                                                                      │
│                            │                                            'video_key': 'videos'}}]                                                                                                 │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ percentiles                │ []                                                                                                                                                                  │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_original_dataset    │ False                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file     │ False                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address                │ 'auto'                                                                                                                                                              │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ debug                      │ False                                                                                                                                                               │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir                   │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow'                                                                                                    │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp                  │ '20241204144335'                                                                                                                                                    │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir                │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow'                                                                                                    │
├────────────────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix                 │ False                                                                                                                                                               │
╘════════════════════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2024-12-04 14:43:38.547 | INFO     | data_juicer.core.executor:__init__:49 - Using cache compression method: [None]
2024-12-04 14:43:38.548 | INFO     | data_juicer.core.executor:__init__:54 - Setting up data formatter...
2024-12-04 14:43:38.548 | INFO     | data_juicer.core.executor:__init__:76 - Preparing exporter...
2024-12-04 14:43:38.549 | INFO     | data_juicer.core.executor:run:153 - Loading dataset from data formatter...
Generating jsonl split: 0 examples [00:00, ? examples/s]Generating jsonl split: 4 examples [00:00, 643.22 examples/s]
2024-12-04 14:43:39.242 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-12-04 14:43:39.242 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 4 sample(s) in the original dataset.
Filter:   0%|          | 0/4 [00:00<?, ? examples/s]Filter: 100%|##########| 4/4 [00:00<00:00, 335.91 examples/s]
2024-12-04 14:43:39.260 | INFO     | data_juicer.format.formatter:unify_format:214 - 4 samples left after filtering empty text.
2024-12-04 14:43:39.260 | INFO     | data_juicer.format.formatter:unify_format:237 - Converting relative paths in the dataset to their absolute version. (Based on the directory of input dataset file)
Map:   0%|          | 0/4 [00:00<?, ? examples/s]Map: 100%|##########| 4/4 [00:00<00:00, 641.16 examples/s]
2024-12-04 14:43:39.271 | INFO     | data_juicer.format.mixture_formatter:load_dataset:137 - sampled 4 from 4
2024-12-04 14:43:39.276 | INFO     | data_juicer.format.mixture_formatter:load_dataset:143 - There are 4 in final dataset
2024-12-04 14:43:39.276 | INFO     | data_juicer.core.executor:run:159 - Preparing process operators...
2024-12-04 14:43:39.277 | INFO     | data_juicer.utils.model_utils:prepare_YOLOv8_human_model:715 - Loading YOLOv8_human model...
2024-12-04 14:43:39.331 | INFO     | data_juicer.utils.model_utils:prepare_face_detect_S3FD_model:573 - Loading face_detect_S3FD_model model...
2024-12-04 14:43:39.499 | INFO     | data_juicer.core.executor:run:166 - Processing data...
video_human_tracks_extraction_mapper_process:   0%|          | 0/4 [00:00<?, ? examples/s]2024-12-04 14:43:39.600 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving S3FDNet to CUDA device 0
2024-12-04 14:43:39.682 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving YOLO to CUDA device 0

  0%|          | 0/6 [00:00<?, ?it/s][A
 17%|#6        | 1/6 [00:01<00:09,  1.97s/it][A
 33%|###3      | 2/6 [00:03<00:05,  1.47s/it][A
 50%|#####     | 3/6 [00:04<00:03,  1.27s/it][A
 67%|######6   | 4/6 [00:04<00:01,  1.02it/s][A
 83%|########3 | 5/6 [00:05<00:01,  1.01s/it][A
100%|##########| 6/6 [00:05<00:00,  1.38it/s][A100%|##########| 6/6 [00:05<00:00,  1.02it/s]
video_human_tracks_extraction_mapper_process:  25%|##5       | 1/4 [00:11<00:34, 11.42s/ examples]2024-12-04 14:43:51.021 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving S3FDNet to CUDA device 0
2024-12-04 14:43:51.023 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving YOLO to CUDA device 0

  0%|          | 0/3 [00:00<?, ?it/s][A
 33%|###3      | 1/3 [00:00<00:01,  1.13it/s][A
 67%|######6   | 2/3 [00:01<00:00,  1.14it/s][A
100%|##########| 3/3 [00:02<00:00,  1.17it/s][A100%|##########| 3/3 [00:02<00:00,  1.16it/s]
video_human_tracks_extraction_mapper_process:  50%|#####     | 2/4 [00:16<00:14,  7.41s/ examples]2024-12-04 14:43:55.627 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving S3FDNet to CUDA device 0
2024-12-04 14:43:55.629 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving YOLO to CUDA device 0

  0%|          | 0/3 [00:00<?, ?it/s][A
 33%|###3      | 1/3 [00:01<00:03,  1.99s/it][A
 67%|######6   | 2/3 [00:03<00:01,  1.98s/it][A
100%|##########| 3/3 [00:05<00:00,  1.97s/it][A100%|##########| 3/3 [00:05<00:00,  1.98s/it]
video_human_tracks_extraction_mapper_process:  75%|#######5  | 3/4 [00:26<00:08,  8.63s/ examples]2024-12-04 14:44:05.696 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving S3FDNet to CUDA device 0
2024-12-04 14:44:05.698 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving YOLO to CUDA device 0

  0%|          | 0/3 [00:00<?, ?it/s][A
 33%|###3      | 1/3 [00:01<00:03,  2.00s/it][A
 67%|######6   | 2/3 [00:03<00:01,  1.98s/it][A
100%|##########| 3/3 [00:05<00:00,  1.98s/it][A100%|##########| 3/3 [00:05<00:00,  1.98s/it]
video_human_tracks_extraction_mapper_process: 100%|##########| 4/4 [00:36<00:00,  9.21s/ examples]video_human_tracks_extraction_mapper_process: 100%|##########| 4/4 [00:36<00:00,  9.05s/ examples]
2024-12-04 14:44:15.799 | INFO     | data_juicer.core.executor:run:255 - Op [video_human_tracks_extraction_mapper] Done in 36.300(s). Left 4 samples.
2024-12-04 14:44:15.799 | INFO     | data_juicer.core.executor:run:259 - All Ops are done in 36.300(s).
2024-12-04 14:44:15.800 | INFO     | data_juicer.core.executor:run:262 - Exporting dataset to disk...
2024-12-04 14:44:15.806 | INFO     | data_juicer.core.exporter:_export_impl:140 - Export dataset into a single file...
Creating json from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating json from Arrow format: 100%|##########| 1/1 [00:00<00:00, 180.56ba/s]
