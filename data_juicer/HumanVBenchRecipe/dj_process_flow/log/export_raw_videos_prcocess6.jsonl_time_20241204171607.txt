2024-12-04 17:16:10.540 | INFO     | data_juicer.config.config:config_backup:646 - Back up the input config file [/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/HumanCentricVideoAnnotationPipeline/process.yaml] into the work_dir [/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow]
2024-12-04 17:16:10.581 | INFO     | data_juicer.config.config:display_config:668 - Configuration table: 
╒════════════════════════════╤════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                        │ values                                                                                                                     │
╞════════════════════════════╪════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                     │ [Path_fr(/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/HumanCentricVideoAnnotationPipeline/process.yaml)]                 │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config                 │ None                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ path_k_sigma_recipe        │ None                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ path_model_feedback_recipe │ None                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_infer_config         │ None                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_train_config         │ None                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_eval_config           │ None                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_eval_config          │ None                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_probe_algo            │ 'uniform'                                                                                                                  │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_probe_ratio           │ 1.0                                                                                                                        │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name               │ 'all'                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type              │ 'default'                                                                                                                  │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path               │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow/raw_videos_prcocess5.jsonl'                                │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path                │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow/raw_videos_prcocess6.jsonl'                                │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size          │ 0                                                                                                                          │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel         │ False                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds       │ False                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds      │ False                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                         │ 1                                                                                                                          │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys                  │ 'text'                                                                                                                     │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key                  │ 'images'                                                                                                                   │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token        │ '<__dj__image>'                                                                                                            │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ audio_key                  │ 'audios'                                                                                                                   │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ audio_special_token        │ '<__dj__audio>'                                                                                                            │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ video_key                  │ 'videos'                                                                                                                   │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ video_special_token        │ '<__dj__video>'                                                                                                            │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token          │ '<|__dj__eoc|>'                                                                                                            │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes                   │ []                                                                                                                         │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache                  │ True                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir               │ '/home/daoyuan_mm/.cache/huggingface/datasets'                                                                             │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress             │ None                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint             │ False                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir                   │ None                                                                                                                       │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer                │ False                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace           │ []                                                                                                                         │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num                  │ 10                                                                                                                         │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion                  │ False                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                    │ [{'video_active_speaker_mapper': {'Light_ASD_model_path': 'weight/finetuning_TalkSet.model',                               │
│                            │                                   'accelerator': 'cpu',                                                                    │
│                            │                                   'acitve_threshold': 30,                                                                  │
│                            │                                   'audio_key': 'audios',                                                                   │
│                            │                                   'batched_op': False,                                                                     │
│                            │                                   'cpu_required': 1,                                                                       │
│                            │                                   'face_track_bbox_path': '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_human_track', │
│                            │                                   'image_key': 'images',                                                                   │
│                            │                                   'mem_required': '10GB',                                                                  │
│                            │                                   'num_proc': 0,                                                                           │
│                            │                                   'tempt_save_path': '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_ASD_tempt',        │
│                            │                                   'text_key': 'text',                                                                      │
│                            │                                   'use_actor': False,                                                                      │
│                            │                                   'video_key': 'videos'}}]                                                                 │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ percentiles                │ []                                                                                                                         │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_original_dataset    │ False                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file     │ False                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address                │ 'auto'                                                                                                                     │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ debug                      │ False                                                                                                                      │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir                   │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow'                                                           │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp                  │ '20241204171607'                                                                                                           │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir                │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow'                                                           │
├────────────────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix                 │ False                                                                                                                      │
╘════════════════════════════╧════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2024-12-04 17:16:10.583 | INFO     | data_juicer.core.executor:__init__:49 - Using cache compression method: [None]
2024-12-04 17:16:10.583 | INFO     | data_juicer.core.executor:__init__:54 - Setting up data formatter...
2024-12-04 17:16:10.584 | INFO     | data_juicer.core.executor:__init__:76 - Preparing exporter...
2024-12-04 17:16:10.585 | INFO     | data_juicer.core.executor:run:153 - Loading dataset from data formatter...
2024-12-04 17:16:11.355 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-12-04 17:16:11.356 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 3 sample(s) in the original dataset.
2024-12-04 17:16:11.364 | INFO     | data_juicer.format.formatter:unify_format:214 - 3 samples left after filtering empty text.
2024-12-04 17:16:11.367 | INFO     | data_juicer.format.formatter:unify_format:237 - Converting relative paths in the dataset to their absolute version. (Based on the directory of input dataset file)
2024-12-04 17:16:11.374 | INFO     | data_juicer.format.mixture_formatter:load_dataset:137 - sampled 3 from 3
2024-12-04 17:16:11.387 | INFO     | data_juicer.format.mixture_formatter:load_dataset:143 - There are 3 in final dataset
2024-12-04 17:16:11.387 | INFO     | data_juicer.core.executor:run:159 - Preparing process operators...
2024-12-04 17:16:11.387 | INFO     | data_juicer.utils.model_utils:prepare_light_asd_model:560 - Loading light_asd model...
12-04 17:16:11 Model para number = 1.02
2024-12-04 17:16:11.531 | INFO     | data_juicer.core.executor:run:166 - Processing data...
video_active_speaker_mapper_process:   0%|          | 0/3 [00:00<?, ? examples/s]2024-12-04 17:16:11.645 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving ASD to CUDA device 0

  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|##        | 1/5 [00:00<00:03,  1.01it/s][A
 40%|####      | 2/5 [00:01<00:02,  1.50it/s][A
 60%|######    | 3/5 [00:01<00:01,  1.75it/s][A
 80%|########  | 4/5 [00:02<00:00,  1.90it/s][A
100%|##########| 5/5 [00:02<00:00,  2.04it/s][A100%|##########| 5/5 [00:02<00:00,  1.80it/s]

  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|##        | 1/5 [00:00<00:03,  1.13it/s][A
 40%|####      | 2/5 [00:01<00:01,  2.22it/s][A
 60%|######    | 3/5 [00:01<00:00,  3.11it/s][A
 80%|########  | 4/5 [00:01<00:00,  3.29it/s][A
100%|##########| 5/5 [00:01<00:00,  4.07it/s][A100%|##########| 5/5 [00:01<00:00,  3.08it/s]
video_active_speaker_mapper_process:  33%|###3      | 1/3 [00:22<00:44, 22.13s/ examples]2024-12-04 17:16:33.777 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving ASD to CUDA device 0

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|##########| 1/1 [00:00<00:00,  2.33it/s][A100%|##########| 1/1 [00:00<00:00,  2.32it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|##########| 1/1 [00:00<00:00,  6.06it/s][A100%|##########| 1/1 [00:00<00:00,  6.00it/s]
video_active_speaker_mapper_process:  67%|######6   | 2/3 [00:28<00:12, 12.61s/ examples]2024-12-04 17:16:39.722 | INFO     | data_juicer.utils.model_utils:move_to_cuda:770 - Moving ASD to CUDA device 0

  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|#####     | 1/2 [00:00<00:00,  1.82it/s][A
100%|##########| 2/2 [00:01<00:00,  1.21it/s][A100%|##########| 2/2 [00:01<00:00,  1.27it/s]

  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|#####     | 1/2 [00:00<00:00,  5.51it/s][A
100%|##########| 2/2 [00:00<00:00,  6.41it/s][A100%|##########| 2/2 [00:00<00:00,  6.23it/s]
