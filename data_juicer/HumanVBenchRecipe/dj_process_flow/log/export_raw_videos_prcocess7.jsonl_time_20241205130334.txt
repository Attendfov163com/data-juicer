2024-12-05 13:03:37.100 | INFO     | data_juicer.config.config:config_backup:646 - Back up the input config file [/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/HumanCentricVideoAnnotationPipeline/process.yaml] into the work_dir [/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow]
2024-12-05 13:03:37.138 | INFO     | data_juicer.config.config:display_config:668 - Configuration table: 
╒════════════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╕
│ key                        │ values                                                                                                                                        │
╞════════════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╡
│ config                     │ [Path_fr(/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/HumanCentricVideoAnnotationPipeline/process.yaml)]                                    │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ hpo_config                 │ None                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ path_k_sigma_recipe        │ None                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ path_model_feedback_recipe │ None                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_infer_config         │ None                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_train_config         │ None                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_eval_config           │ None                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ model_eval_config          │ None                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_probe_algo            │ 'uniform'                                                                                                                                     │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_probe_ratio           │ 1.0                                                                                                                                           │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ project_name               │ 'all'                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ executor_type              │ 'default'                                                                                                                                     │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_path               │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow/raw_videos_prcocess6.jsonl'                                                   │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_path                │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow/raw_videos_prcocess7.jsonl'                                                   │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_shard_size          │ 0                                                                                                                                             │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_in_parallel         │ False                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_stats_in_res_ds       │ False                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ keep_hashes_in_res_ds      │ False                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ np                         │ 1                                                                                                                                             │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ text_keys                  │ 'text'                                                                                                                                        │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_key                  │ 'images'                                                                                                                                      │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ image_special_token        │ '<__dj__image>'                                                                                                                               │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ audio_key                  │ 'audios'                                                                                                                                      │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ audio_special_token        │ '<__dj__audio>'                                                                                                                               │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ video_key                  │ 'videos'                                                                                                                                      │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ video_special_token        │ '<__dj__video>'                                                                                                                               │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eoc_special_token          │ '<|__dj__eoc|>'                                                                                                                               │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ suffixes                   │ []                                                                                                                                            │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_cache                  │ True                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ds_cache_dir               │ '/home/daoyuan_mm/.cache/huggingface/datasets'                                                                                                │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ cache_compress             │ None                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ use_checkpoint             │ False                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ temp_dir                   │ None                                                                                                                                          │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ open_tracer                │ False                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_list_to_trace           │ []                                                                                                                                            │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ trace_num                  │ 10                                                                                                                                            │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ op_fusion                  │ False                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ process                    │ [{'video_captioning_from_human_tracks_mapper': {'accelerator': 'cpu',                                                                         │
│                            │                                                 'audio_key': 'audios',                                                                        │
│                            │                                                 'batched_op': False,                                                                          │
│                            │                                                 'cpu_required': 1,                                                                            │
│                            │                                                 'human_track_query': 'Descibe '                                                               │
│                            │                                                                      'the '                                                                   │
│                            │                                                                      "person's "                                                              │
│                            │                                                                      'apperance. ',                                                           │
│                            │                                                 'image_key': 'images',                                                                        │
│                            │                                                 'mem_required': '35GB',                                                                       │
│                            │                                                 'num_proc': 0,                                                                                │
│                            │                                                 'tempt_video_path': '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_tmpt',                 │
│                            │                                                 'text_key': 'text',                                                                           │
│                            │                                                 'use_actor': False,                                                                           │
│                            │                                                 'video_describe_model_path': '/mnt/daoyuan_open_research/zt_data/pt_model/sharegpt4video-8b', │
│                            │                                                 'video_key': 'videos'}}]                                                                      │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ percentiles                │ []                                                                                                                                            │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ export_original_dataset    │ False                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_stats_in_one_file     │ False                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ray_address                │ 'auto'                                                                                                                                        │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ debug                      │ False                                                                                                                                         │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ work_dir                   │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow'                                                                              │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ timestamp                  │ '20241205130334'                                                                                                                              │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ dataset_dir                │ '/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/dj_process_flow'                                                                              │
├────────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ add_suffix                 │ False                                                                                                                                         │
╘════════════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╛
2024-12-05 13:03:37.139 | INFO     | data_juicer.core.executor:__init__:49 - Using cache compression method: [None]
2024-12-05 13:03:37.139 | INFO     | data_juicer.core.executor:__init__:54 - Setting up data formatter...
2024-12-05 13:03:37.140 | INFO     | data_juicer.core.executor:__init__:76 - Preparing exporter...
2024-12-05 13:03:37.140 | INFO     | data_juicer.core.executor:run:153 - Loading dataset from data formatter...
2024-12-05 13:03:37.940 | INFO     | data_juicer.format.formatter:unify_format:185 - Unifying the input dataset formats...
2024-12-05 13:03:37.941 | INFO     | data_juicer.format.formatter:unify_format:200 - There are 3 sample(s) in the original dataset.
2024-12-05 13:03:37.949 | INFO     | data_juicer.format.formatter:unify_format:214 - 3 samples left after filtering empty text.
2024-12-05 13:03:37.952 | INFO     | data_juicer.format.formatter:unify_format:237 - Converting relative paths in the dataset to their absolute version. (Based on the directory of input dataset file)
2024-12-05 13:03:37.960 | INFO     | data_juicer.format.mixture_formatter:load_dataset:137 - sampled 3 from 3
2024-12-05 13:03:37.973 | INFO     | data_juicer.format.mixture_formatter:load_dataset:143 - There are 3 in final dataset
2024-12-05 13:03:37.973 | INFO     | data_juicer.core.executor:run:159 - Preparing process operators...
2024-12-05 13:03:37.974 | INFO     | data_juicer.utils.model_utils:prepare_sharegpt4video_model:697 - Loading sharegpt4video model...
Load vision tower from openai/clip-vit-large-patch14-336
2024-12-05 13:03:38.253 | ERROR    | __main__:<module>:27 - An error has been caught in function '<module>', process 'MainProcess' (241523), thread 'MainThread' (140526751707584):
Traceback (most recent call last):

  File "/home/daoyuan_mm/miniconda3/envs/videollama/lib/python3.9/site-packages/transformers/utils/hub.py", line 403, in cached_file
    resolved_file = hf_hub_download(
                    └ <function hf_hub_download at 0x7fce0af88c10>
  File "/home/daoyuan_mm/miniconda3/envs/videollama/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py", line 106, in _inner_fn
    validate_repo_id(arg_value)
    │                └ '/mnt1/daoyuan_mm/clip-vit-large-patch14-336'
    └ <function validate_repo_id at 0x7fce0afdba60>
  File "/home/daoyuan_mm/miniconda3/envs/videollama/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py", line 154, in validate_repo_id
    raise HFValidationError(
          └ <class 'huggingface_hub.errors.HFValidationError'>

huggingface_hub.errors.HFValidationError: Repo id must be in the form 'repo_name' or 'namespace/repo_name': '/mnt1/daoyuan_mm/clip-vit-large-patch14-336'. Use `repo_type` argument if needed.


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/home/daoyuan_mm/miniconda3/envs/videollama/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
           │         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': <_frozen_importlib_external.SourceFileLoader objec...
           │         └ <code object <module> at 0x7fcee1a39450, file "/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x6...
           └ <function _run_code at 0x7fcee1a369d0>
  File "/home/daoyuan_mm/miniconda3/envs/videollama/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': <_frozen_importlib_external.SourceFileLoader objec...
         └ <code object <module> at 0x7fcee1a39450, file "/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x6...

  File "/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py", line 39, in <module>
    cli.main()
    │   └ <function main at 0x7fcee05a0280>
    └ <module 'debugpy.server.cli' from '/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x64/bundled/li...

  File "/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 430, in main
    run()
    └ <function run_file at 0x7fcee05a0040>

  File "/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 284, in run_file
    runpy.run_path(target, run_name="__main__")
    │     │        └ '/home/daoyuan_mm/data_juicer/tools/process_data.py'
    │     └ <function run_path at 0x7fcee0a9d820>
    └ <module '_pydevd_bundle.pydevd_runpy' from '/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x64/b...

  File "/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x64/bundled/libs/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 321, in run_path
    return _run_module_code(code, init_globals, run_name,
           │                │     │             └ '__main__'
           │                │     └ None
           │                └ <code object <module> at 0x7fcee042a3a0, file "/home/daoyuan_mm/data_juicer/tools/process_data.py", line 4>
           └ <function _run_module_code at 0x7fcee0a8ee50>

  File "/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x64/bundled/libs/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 135, in _run_module_code
    _run_code(code, mod_globals, init_globals,
    │         │     │            └ None
    │         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': None, '__spec__': None, '__file__': '/home/daoyuan...
    │         └ <code object <module> at 0x7fcee042a3a0, file "/home/daoyuan_mm/data_juicer/tools/process_data.py", line 4>
    └ <function _run_code at 0x7fcee0a8eb80>

  File "/home/daoyuan_mm/.vscode-server/extensions/ms-python.debugpy-2024.0.0-linux-x64/bundled/libs/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 124, in _run_code
    exec(code, run_globals)
         │     └ {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': None, '__spec__': None, '__file__': '/home/daoyuan...
         └ <code object <module> at 0x7fcee042a3a0, file "/home/daoyuan_mm/data_juicer/tools/process_data.py", line 4>

> File "/home/daoyuan_mm/data_juicer/tools/process_data.py", line 27, in <module>
    main()
    └ <function main at 0x7fcbe1d290d0>

  File "/home/daoyuan_mm/data_juicer/tools/process_data.py", line 23, in main
    executor.run()
    │        └ <function Executor.run at 0x7fcbe1d1aee0>
    └ <data_juicer.core.executor.Executor object at 0x7fcbcc84e850>

  File "/home/daoyuan_mm/data_juicer/data_juicer/core/executor.py", line 160, in run
    self.process_list, self.ops = load_ops(self.cfg.process,
    │    │             │    │     │        │    │   └ [{'video_captioning_from_human_tracks_mapper': {'human_track_query': "Descibe the person's apperance. ", 'video_describe_mode...
    │    │             │    │     │        │    └ Namespace(config=[Path_fr(/home/daoyuan_mm/data_juicer/HumanVBenchRecipe/HumanCentricVideoAnnotationPipeline/process.yaml)], ...
    │    │             │    │     │        └ <data_juicer.core.executor.Executor object at 0x7fcbcc84e850>
    │    │             │    │     └ <function load_ops at 0x7fcc0b3294c0>
    │    │             │    └ None
    │    │             └ <data_juicer.core.executor.Executor object at 0x7fcbcc84e850>
    │    └ [{'video_captioning_from_human_tracks_mapper': {'human_track_query': "Descibe the person's apperance. ", 'video_describe_mode...
    └ <data_juicer.core.executor.Executor object at 0x7fcbcc84e850>

  File "/home/daoyuan_mm/data_juicer/data_juicer/ops/load.py", line 28, in load_ops
    ops.append(OPERATORS.modules[op_name](**args))
    │   │      │         │       │          └ {'human_track_query': "Descibe the person's apperance. ", 'video_describe_model_path': '/mnt/daoyuan_open_research/zt_data/pt...
    │   │      │         │       └ 'video_captioning_from_human_tracks_mapper'
    │   │      │         └ <property object at 0x7fcde006cae0>
    │   │      └ <data_juicer.utils.registry.Registry object at 0x7fce082ec700>
    │   └ <method 'append' of 'list' objects>
    └ []

  File "/home/daoyuan_mm/data_juicer/data_juicer/ops/mapper/video_captioning_from_human_tracks_mapper.py", line 74, in __init__
    self.model_key = prepare_model(
    │                └ <function prepare_model at 0x7fcc71bbf550>
    └ <data_juicer.ops.mapper.video_captioning_from_human_tracks_mapper.VideoCaptioningFromHumanTracksMapper object at 0x7fcbd8fe52e0>

  File "/home/daoyuan_mm/data_juicer/data_juicer/utils/model_utils.py", line 754, in prepare_model
    model_objects = model_key()
                    └ functools.partial(<function prepare_sharegpt4video_model at 0x7fcc71bbf430>, pretrained_model_name_or_path='/mnt/daoyuan_open...

  File "/home/daoyuan_mm/data_juicer/data_juicer/utils/model_utils.py", line 699, in prepare_sharegpt4video_model
    tokenizer, model, processor, context_len = load_pretrained_model(
                                               └ <function load_pretrained_model at 0x7fcc46cb5160>

  File "/home/daoyuan_mm/data_juicer/data_juicer/my_pretrained_method/ShareGPT4Video/llava/model/builder.py", line 145, in load_pretrained_model
    model = LlavaLlamaForCausalLM.from_pretrained(
            │                     └ <classmethod object at 0x7fcbe9a8a3d0>
            └ <class 'llava.model.language_model.llava_llama.LlavaLlamaForCausalLM'>

  File "/home/daoyuan_mm/miniconda3/envs/videollama/lib/python3.9/site-packages/transformers/modeling_utils.py", line 4096, in from_pretrained
    model = cls(config, *model_args, **model_kwargs)
            │   │        │             └ {}
            │   │        └ ()
            │   └ LlavaConfig {
            │       "_attn_implementation_autoset": true,
            │       "_name_or_path": "/mnt/daoyuan_open_research/zt_data/pt_model/sharegp...
            └ <class 'llava.model.language_model.llava_llama.LlavaLlamaForCausalLM'>

  File "/home/daoyuan_mm/data_juicer/data_juicer/my_pretrained_method/ShareGPT4Video/llava/model/language_model/llava_llama.py", line 46, in __init__
    self.model = LlavaLlamaModel(config)
    │            │               └ LlavaConfig {
    │            │                   "_attn_implementation_autoset": true,
    │            │                   "_name_or_path": "/mnt/daoyuan_open_research/zt_data/pt_model/sharegp...
    │            └ <class 'llava.model.language_model.llava_llama.LlavaLlamaModel'>
    └ LlavaLlamaForCausalLM()

  File "/home/daoyuan_mm/data_juicer/data_juicer/my_pretrained_method/ShareGPT4Video/llava/model/language_model/llava_llama.py", line 38, in __init__
    super(LlavaLlamaModel, self).__init__(config)
          │                │              └ LlavaConfig {
          │                │                  "_attn_implementation_autoset": true,
          │                │                  "_name_or_path": "/mnt/daoyuan_open_research/zt_data/pt_model/sharegp...
          │                └ LlavaLlamaModel(
          │                    (embed_tokens): Embedding(128257, 4096, padding_idx=128256)
          │                    (layers): ModuleList(
          │                      (0-31): 32 x Llama...
          └ <class 'llava.model.language_model.llava_llama.LlavaLlamaModel'>

  File "/home/daoyuan_mm/data_juicer/data_juicer/my_pretrained_method/ShareGPT4Video/llava/model/llava_arch.py", line 34, in __init__
    self.vision_tower = build_vision_tower(config, delay_load=True)
    │                   │                  └ LlavaConfig {
    │                   │                      "_attn_implementation_autoset": true,
    │                   │                      "_name_or_path": "/mnt/daoyuan_open_research/zt_data/pt_model/sharegp...
    │                   └ <function build_vision_tower at 0x7fcc46cf0a60>
    └ LlavaLlamaModel(
        (embed_tokens): Embedding(128257, 4096, padding_idx=128256)
        (layers): ModuleList(
          (0-31): 32 x Llama...

  File "/home/daoyuan_mm/data_juicer/data_juicer/my_pretrained_method/ShareGPT4Video/llava/model/multimodal_encoder/builder.py", line 15, in build_vision_tower
    return CLIPVisionTower(vision_tower, args=vision_tower_cfg, **kwargs)
           │               │                  │                   └ {'delay_load': True}
           │               │                  └ LlavaConfig {
           │               │                      "_attn_implementation_autoset": true,
           │               │                      "_name_or_path": "/mnt/daoyuan_open_research/zt_data/pt_model/sharegp...
           │               └ 'openai/clip-vit-large-patch14-336'
           └ <class 'llava.model.multimodal_encoder.clip_encoder.CLIPVisionTower'>

  File "/home/daoyuan_mm/data_juicer/data_juicer/my_pretrained_method/ShareGPT4Video/llava/model/multimodal_encoder/clip_encoder.py", line 20, in __init__
    self.load_model()
    │    └ <function CLIPVisionTower.load_model at 0x7fcc46cf0e50>
    └ CLIPVisionTower()

  File "/home/daoyuan_mm/data_juicer/data_juicer/my_pretrained_method/ShareGPT4Video/llava/model/multimodal_encoder/clip_encoder.py", line 29, in load_model
    self.image_processor = CLIPImageProcessor.from_pretrained('/mnt1/daoyuan_mm/clip-vit-large-patch14-336')
    │                      │                  └ <classmethod object at 0x7fcda034ce20>
    │                      └ <class 'transformers.models.clip.image_processing_clip.CLIPImageProcessor'>
    └ CLIPVisionTower()

  File "/home/daoyuan_mm/miniconda3/envs/videollama/lib/python3.9/site-packages/transformers/image_processing_base.py", line 206, in from_pretrained
    image_processor_dict, kwargs = cls.get_image_processor_dict(pretrained_model_name_or_path, **kwargs)
                                   │   │                        │                                └ {'cache_dir': None, 'force_download': False, 'local_files_only': False, 'revision': 'main'}
                                   │   │                        └ '/mnt1/daoyuan_mm/clip-vit-large-patch14-336'
                                   │   └ <classmethod object at 0x7fcda034ce80>
                                   └ <class 'transformers.models.clip.image_processing_clip.CLIPImageProcessor'>
  File "/home/daoyuan_mm/miniconda3/envs/videollama/lib/python3.9/site-packages/transformers/image_processing_base.py", line 335, in get_image_processor_dict
    resolved_image_processor_file = cached_file(
                                    └ <function cached_file at 0x7fcdc0219160>
  File "/home/daoyuan_mm/miniconda3/envs/videollama/lib/python3.9/site-packages/transformers/utils/hub.py", line 469, in cached_file
    raise EnvironmentError(

OSError: Incorrect path_or_model_id: '/mnt1/daoyuan_mm/clip-vit-large-patch14-336'. Please provide either the path to a local folder or the repo_id of a model on the Hub.
